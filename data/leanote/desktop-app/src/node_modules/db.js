var Datastore = require('nedb');
var path = require('path');
var Evt = require('evt');

// 数据库初始化
// var dbPath = require('nw.gui').App.dataPath + '/nedb';
// var dbPath = Evt.getBasePath() + '/Users/life/Library/Application Support/Leanote' + '/nedb';
// nedb2 为了port
var dbPath = Evt.getBasePath() + '/nedb2';
// console.error(dbPath);

// test
if(dbPath.length < 6) {
	var dbPath = '/Users/life/Library/Application Support/Leanote' + '/nedb2';
}

// console.log(dbPath);
// g, 表全局环境
var db = {};
var dbNames = ['notebooks', 'notes', 'users', 'tags', 'images', 'attachs', 'noteHistories', 'g'];
for(var i in dbNames) {
	var name = dbNames[i];
	var p = path.join(dbPath, name + '.db');
	// console.log(p);
	db[name] = new Datastore({ filename: p, autoload: true });
}
module.exports = db; 
console.log('db inited');