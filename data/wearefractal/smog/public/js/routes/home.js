// Generated by CoffeeScript 1.3.3
(function() {

  define(["smog/server", "smog/util", "smog/notify", "templates/sidebar", "templates/admin"], function(server, util, notify, sidebar, admin) {
    return {
      show: function() {
        return server.admin(function(err, info) {
          if (err != null) {
            return notify.error("Error grabbing information: " + (err.err || err));
          }
          info.collections = util.filterCollections(info.collections);
          $('#sidebar').html(sidebar(info));
          info.serverStatus.network.bytesIn = util.readableSize(info.serverStatus.network.bytesIn);
          info.serverStatus.network.bytesOut = util.readableSize(info.serverStatus.network.bytesOut);
          info.serverStatus.mem.mapped = "" + info.serverStatus.mem.mapped + " MB";
          info.serverStatus.mem.virtual = "" + info.serverStatus.mem.virtual + " MB";
          info.serverStatus.connections.total = info.serverStatus.connections.current + info.serverStatus.connections.available;
          info.serverStatus.uptime = util.prettySeconds(info.serverStatus.uptime);
          return $('#content').html(admin(info));
        });
      }
    };
  });

}).call(this);
